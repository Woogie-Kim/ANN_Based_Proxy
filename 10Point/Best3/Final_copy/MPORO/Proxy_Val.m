function [Y,Xf,Af] = Proxy_Val(X,~,~)
%PROXY_VAL neural network simulation function.
%
% Auto-generated by MATLAB, 24-May-2021 11:55:17.
% 
% [Y] = Proxy_Val(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 10xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [100;0.5;200;0.0001;0.054;0.001;0.01];
x1_step1.gain = [0.005;0.408163265306122;0.005;2222.22222222222;24.6913580246914;222.222222222222;66.6666666666667];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1403388311645052955;-0.42063405109724749664;0.071918307143983492558;-1.0456824092824010819;0.84312179626858985149;0.19820847786278231184];
IW1_1 = [-0.042092642091773838087 -0.03507302890795975514 0.073327017218292517287 0.03928158220554064245 -0.03800753904172803066 0.32155681398358065826 -0.016645289325572475841;0.028037769886705737193 -0.62633723109405869955 0.15987834105387913053 0.00035261984141663914229 0.091931822620542585911 0.066237517540953652628 0.036247256270017423618;0.078582015222269249732 -0.14934761983993624646 0.54477999078435346281 0.01952246432114632807 0.094454677679184681494 0.036527471680018082367 0.038693418115817251879;-0.48871965539501005527 0.10577345939656772333 -0.1819367746009025455 0.0033916176170318813009 0.070461692112547907874 0.028389816944497631157 0.021316046135318438698;-0.019874141749039023197 -0.10374745082348374448 0.011662217843001301473 0.038650167776010276033 -0.035884165655612872137 0.4342430566103538947 -0.014407690760283663189;0.055870401915425048356 -0.017138420386095063602 0.065386482017629102281 0.011416385756035317064 0.11105313148397441547 0.054957558270760965835 0.04006454164502290527];

% Layer 2
b2 = [-2.1695786115326773924;-1.8410225559790693861;1.8392713919047793958;-0.0049722597289657832764;0.14027479346059598675;-2.3390368730873336567;0.8166753076072464923;-1.4107812072902976563;0.12761490495597915817;0.094070224426866203005;1.2500998887776755275;-0.91637976460779546617;0.35945002842885098726;-0.56703691010159440467;0.21977980774922317719;0.12221224325093818508;-3.2107136248573606707;0.61932571051794405026;-2.2606955556694909859;-1.6038396417230189606];
LW2_1 = [0.06008121593913862829 -0.21678531383465718396 -0.31431309933708717619 0.11075614856589524604 1.1178534374732611578 2.1354431529957120794;1.8366078282969908742 -0.10233194608191721608 -0.36671605395398382266 -0.26763515133399734536 -1.7324530368981374551 1.8658556133660233467;0.68616436111935219522 -1.8440848986665887566 2.174282896744317739 0.56772907140232919954 -1.164349451310595418 -0.70822026241290303439;-1.0347129067645028933 1.2490580378031652664 0.94694445317431974463 -1.5833839259955058143 -0.46616780770622651131 0.98015705916960027544;-1.5818442881427305924 0.079932733619959228655 -0.48728018831965930202 -0.18461473227374544659 1.1528484501521476524 -2.0021410592598578582;-1.1468329840749218462 1.5279249080451153819 -0.89151690692676544003 -2.0182632933376098983 2.1940985012636882168 0.66760863531131386939;-0.32550116585132277125 1.4072687945135824439 -0.94607426344326306378 -0.67316311541295847931 0.70188746811923641289 1.3809296440622631508;-1.3022102214726534175 -0.13884387344424189981 -2.2006494767500393017 -0.26209583441278527793 0.49819113072915083285 1.7716494790206713805;-0.81867591971460784706 -0.0069008196311204465789 0.010495232801889204516 0.26776166012197988309 -1.8552494321614505512 -0.38505285322633669987;0.8250468278551440493 -0.047800968840634422419 0.11055818248123855385 -0.32992624251487168152 1.4015282333738476872 0.65066569614074054595;-2.1144377355987620248 -1.2127002490595670814 1.1474946134951407029 1.2712587926199754307 -0.14185430471177823408 -1.7712947949461199659;2.594764624864086322 0.59809411365069153899 -3.1776173253091535287 -0.4552940699677245906 -1.7165159449185218854 2.3287696637621078111;1.7252178761101404358 0.23550956976264805776 0.13339033187254256685 -0.12403952037451713986 -1.1947734719555413996 0.18325635157676145592;1.1892382180515406187 -0.068044262972204019868 0.5874168911322434905 -0.20897256565603047895 -0.53608420996307470929 0.91007145972187453165;1.9277901919094275751 -0.049430270863650115076 -0.31421080979338444905 1.1985168933711567441 -1.3931533388852517241 -0.73804012132854424078;0.78019865369251362175 0.037825722912966361355 -0.05675641499125851086 -0.20119365074353776079 1.9939465829694982268 0.18773314141647828857;-2.0342464697363933368 0.88941827469961332042 -0.59378589434669848401 0.06360560982899224336 1.9250098098459360596 1.140457858604402297;-2.0659935400920632631 -0.25255912913192146707 -0.52256026386543075191 -1.3623391491938798836 -0.057926898998036518984 1.2557471218766034227;1.9462261144835597548 -0.47058189929404653506 -0.14377361534386354225 -1.2747590495349068185 0.36846193818192868319 -1.9695661766492766898;-1.9118388245643387346 3.1050514415233561039 -1.5685961013703295652 -0.75577642641434727988 1.6613423307985664135 -0.29171505352279475387];

% Layer 3
b3 = [-1.1515218940849127893;-0.70036141012124242256;-0.67929643834141995029;-2.0552264007875065133;-1.0613576895455802962;-1.5449453995166229081;-1.9999637140213784026;-1.0081254623006885573;-1.4518703159154120463;-1.5224893158147099204];
LW3_2 = [0.39438027838275879766 0.39609410051648757944 0.18479179602031259311 -0.035264310967313354517 0.31619647665245942392 -0.11541245330966092009 -0.81169578793257524119 2.0054644339844092116 -0.16307134605140652384 0.6543498348651293206 -1.2682950760015061498 0.23246459749757406033 -0.62998082643647046464 1.8329532765919458459 0.63879385464084270652 -0.070119802070003872663 -1.1522580279532461667 0.12455204991084078969 0.3457117161991782317 -0.51245812624332454099;0.41915923949668165704 0.66204165244888346642 0.068478399820764188077 -0.073118538607731944912 0.029785680794037792257 -0.16245363654285194244 -0.73246880184942297909 1.7799110953133938651 0.25145763551209410203 0.70450953170210472987 -1.1164413876794847535 0.23844219560304286132 -0.19587662641764949645 1.2324535472485407261 0.28833091948330108467 0.82573465028000048171 0.15555169577473487719 0.003117502774318995501 0.37313148124237871528 -0.7243432642241736108;0.45084793262859823582 0.84904327881199992412 -0.025823426531552139129 -0.081745405124404854624 -0.15325087886845761842 -0.19190851208703357811 -0.65653279813792320141 1.6190584619188574944 -1.5318663402652472616 -0.29742349543031554315 -0.97379973288427812417 0.24303314215138291376 -0.076366444140956252218 0.86883893505405107582 0.076896113426930631785 -0.42088953180211452487 -0.22707602468455956313 -0.075868747216154011626 0.39430587986977644332 -0.87953399464302939315;0.49153638153734813265 1.0085570842987510165 -0.087684496955889285053 -0.08026909619122127304 -0.30015194493364427686 -0.21492086548541236568 -0.60429157486113238562 1.476804039269486335 0.35744580258504493608 0.80805173589888534824 -0.86153958923478590748 0.23767327577989272314 -0.046719669978531087884 0.52106599362351413429 -0.089894198345726580857 1.4634398386209741538 -0.5540512767869504307 -0.13442501134307272004 0.40362055242828748236 -0.99050643895037282505;0.52733292206801007929 1.0985489842766500423 -0.14406999036004022874 -0.076267084040519281252 -0.40058399943899858364 -0.23124496626720583703 -0.55513839804666920141 1.3679343618540173999 -0.50800650556692061866 0.54537920397076433687 -0.76866260646239847887 0.23507408671202281725 -0.11848525893104418227 0.31171025499755461441 -0.1996084751764951315 0.66931754895442896469 0.18382598041557118851 -0.17113031941810974423 0.41007861653783694855 -1.0910140800914820414;0.55107886223854163354 1.1792480492651633561 -0.21290571274261119172 -0.06742244906101135804 -0.4496939257215943897 -0.23833081327826063922 -0.53487259584933843914 1.2878704989896718747 -1.2227667912419424301 -0.039061147910547391882 -0.72260523708082513572 0.23858395290219588936 -0.27506940260219914229 0.23752874069281310065 -0.25942546943436312068 0.28939121465039369108 -0.66663224570747825481 -0.201693213012601541 0.41561289597756806424 -1.1916842863340335601;0.57666702579397488559 1.2494775541670866126 -0.26695370750636682189 -0.058708936772831524231 -0.49506354329857776841 -0.24488967494509000788 -0.515675899542031968 1.2138721480960463772 -0.97284363509003057846 -0.014902863067535977379 -0.67872146303159830438 0.23847803350277585466 -0.42051577871993905955 0.15088650681677848175 -0.31361790712446246943 0.69909773922315043837 -1.0583540936684590061 -0.22643761724758512677 0.41814926085622466934 -1.2746760663746947717;0.59875519202298821408 1.3151313587651838333 -0.30634304459545869115 -0.050679937769502206302 -0.53961859761941322056 -0.25268146475804020845 -0.49077118365954491841 1.1423698380405939989 0.054659959849295960965 0.51028198020715465066 -0.63006561852430642556 0.23439061258146084987 -0.5659718324417462032 0.050465000304040025236 -0.36519654190182249121 1.7432266961425202378 0.35808354396764630057 -0.24561736612004636537 0.41946225458169755784 -1.3482073289563989427;0.61626123579483904624 1.364479521266322104 -0.35906780986587305549 -0.041206684668423441964 -0.55282759250093871373 -0.25397547810777859612 -0.48453003992014659351 1.0919326070920720717 -0.02737153973185054226 0.2085693624402278068 -0.61159102645972773793 0.23707999691281997356 -0.74467271397465595317 0.047940041691668870694 -0.3863288528069496186 1.9306942493179266584 -0.24653863645511764346 -0.26251451873677078552 0.42104180403614499539 -1.4223215629903069868;0.64833888163534514337 1.3657157696534221181 -0.39895665360593318693 -0.03570670279353213572 -0.5754386083887527148 -0.25628955675521580826 -0.46617644526018459095 1.0498965420589136954 -2.3350220164256874078 -0.90345585876552003679 -0.57630628138065731481 0.23957726101825108089 -0.85666904581479241809 0.028878943747519796731 -0.41105175758371698125 -0.22207833305730162454 -1.3443647903293609591 -0.27245157358386057345 0.4203710898136668872 -1.4756592400127892528];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.000512226018050363;0.000308134497287773;0.000235603722003516;0.000197382386246029;0.000173329147318873;0.000156560839315145;0.000144063610768706;0.000134303255326914;0.000126411888057116;0.000119860003755334];
y1_step1.xoffset = [246.25792;461.32665;664.62166;860.12562;1049.6188;1234.1264;1414.3177;1590.7342;1763.7242;1933.6147];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
