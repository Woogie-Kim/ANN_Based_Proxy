function [Y,Xf,Af] = Proxy_Val(X,~,~)
%PROXY_VAL neural network simulation function.
%
% Auto-generated by MATLAB, 14-Jun-2021 00:10:53.
% 
% [Y] = Proxy_Val(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 7xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 10xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [100;0.5;200;0.0001;0.054;0.001;0.01];
x1_step1.gain = [0.005;0.408163265306122;0.005;2222.22222222222;24.6913580246914;222.222222222222;66.6666666666667];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.90338793006801521024;0.17418855143387163009;-1.031608747471403964;0.11976858850039762139;1.1049782978221691643;-0.54620211620260905594];
IW1_1 = [-0.012193400521286854032 0.20028250865351276966 -0.21329485362934061388 -0.023666788514790298298 -0.17276239593201708766 0.016633367828382140258 -0.068973488488778558758;0.034446650614331032758 -0.23351462063740358044 1.0337810852317905752 0.01457389053976148631 0.020484048710703264828 0.016015390340398123759 0.0237638488665842737;0.019151012655491534559 -0.37589448218686544179 0.02058878314717846672 -0.014726171263986899754 0.02345858711689693954 0.047388966977876631481 0.0085065374991219952494;0.033023472697804152898 0.11220631739122167991 0.06570478160487028263 -0.0016132062320671450729 0.045274949235473239961 0.052478292185944755421 0.016204202305119493055;0.012505856495597907421 -0.1199844484592588606 -0.027486764236306363701 0.092705601302850368373 0.0096629045002593928759 0.6248733343026388054 -0.0032080628092570340204;-0.67346345354638825764 0.36384086217363248439 -0.17019651075536923468 -0.02399428338387723722 -0.030771873198591478266 -0.23259381493108427508 -0.014444208285276241913];

% Layer 2
b2 = [2.9988161729639193354;1.4855814775824816021;1.617219666519461585;-0.69210580568626023368;1.1752247639831203685;-1.2551308396639990761;-2.4520216559102481213;-3.2631169135552928751;2.0019607598330684262;1.0544001230967092742;-2.4322612671924508376;-0.78585765491298098517;1.4259142566106384198;3.0375669860371528053];
LW2_1 = [0.23169502651390364023 3.0804568498881055305 -0.46663723108732702016 -1.3206904098628053923 0.13932995252057117641 0.13993629024558909557;-2.8679672896805947779 -0.5024900724561605081 -3.0128142161075377459 -0.81432103216369022824 -1.1021373170906274552 -2.5183886771085206568;0.61572738066112686628 1.5488709098002721998 0.21970528288883436896 -3.2275599327676052219 2.4402664748005538087 1.577391854172779162;1.5698618104066335288 -0.70858738698676437817 1.1085313121360038657 1.0485115900603700911 -1.3698861658744176939 2.6851052771366661354;2.6318027722151264847 0.15044167675538047679 -1.9514288708465870048 0.48542027771408136072 -0.70907660653839266196 -0.75260534134067824663;-2.0178521940900582265 -0.023633647367011467039 1.8581191911143777329 -1.542380487227840824 1.1830307974295564133 0.4135057800427280883;-2.3463607798442569496 -0.25831500099822074512 1.3696240230500356105 1.2668221145239297876 0.86898820829751111106 2.2771784394265885965;-0.15606613284194567615 -0.43064944675444449818 -1.3468591755423464651 0.92283961394773594833 1.5606178773690009276 -0.012676439543612628286;-0.61200314198979888225 0.31770687331710972812 1.8070147469217097136 0.79507041074698792116 -0.5213114325313014108 -0.15386582489522468431;0.025670519698737997299 0.36076404383665272579 0.53482274740996493811 -0.98735933437891409969 -1.1868303307002965319 0.026318153076554419434;0.28998143583948310376 -0.40137344723230727883 -2.2091449963801994549 -0.40332530331398208645 0.5092779538033117559 0.052946791751201226217;0.32951847490057734058 -0.031553752853234334763 0.79756764529875745495 0.76103648972028936637 1.8767968781510786513 -0.0084734714578700385396;1.7219897260404186667 0.37066656533214537017 -2.4989503047870695873 2.7128285899045634366 -0.63299763368925199281 0.36335809008722264046;0.50513512235413970952 2.9953251916198149196 -2.0102028547614430032 -0.14792249415077890484 -0.5733578625622658409 0.19141598049030955631];

% Layer 3
b3 = [-1.8263225582407167646;-1.2550329772099888537;-1.4885774067620649586;-1.32593923353523091;-1.3973889644257806442;-0.87662053113937266069;-0.96904791211664542683;-0.8360207540804037718;-0.93228255344498811574;-0.93928083253535210595];
LW3_2 = [-1.7028243411710886068 -0.091051513763894351139 0.12296022665930166073 -0.89636920414271603619 0.21217721860175331461 0.32497269632281045038 -0.23995386436685650633 0.64673828307420566652 1.6401757644404677539 -0.6486107196714463452 1.5826345644111377009 -0.51125600682237060113 0.87825053191037261158 1.2015528142249307653;-1.3817016887037016915 -0.36488174265846845534 0.062756685137684856124 -0.7610113683061748846 0.3530914682790617376 0.52285547052695280357 -0.23130738440116724308 0.85112191128515723992 1.5228879659207219532 -0.86995328134869676084 1.2104516009723085279 -0.69359842396493576189 1.0503170585502925594 0.60690524868295570027;-1.1865262944531722589 0.09464513484085074202 0.024394110933051584011 -0.65462282207292044056 0.44517672672484898122 0.64342239258766542598 -0.21707540110883674633 1.0307154871378330085 1.3360726898574013521 -1.0360342420899519844 0.82658858973051985153 -0.82983998113334600522 1.1636498116141134052 0.24212903855777370699;-1.0527729587042391479 0.10849604293063846994 -0.0018326610574081782234 -0.57132589870455419145 0.51083995299576501203 0.72567858293958698024 -0.20452913394586985651 1.1867367622155002849 1.1444407930163713605 -1.1675800306196124634 0.47506028245583520331 -0.93636059465391008327 1.2452675331639988521 -0.010292673312647515962;-0.95477629164982924515 0.32216911523080765667 -0.020839261531546401929 -0.50414190856142837571 0.56035878358512236641 0.78546676522980152235 -0.19344551096875811647 1.32338860954488724 0.96067803362675741052 -1.2757042583505295852 0.15757289871089061317 -1.0224181213739691465 1.3074101888115527981 -0.19540787818969621026;-0.87928514682660707802 -0.081074358563651971465 -0.03485810635169559607 -0.44868012043825999946 0.59832782957798369416 0.83016075577331305269 -0.18453101830758081303 1.4424189308104300444 0.79391168325928374028 -1.3662931247520673228 -0.12306609159199188852 -1.0928089316623026406 1.3562899183413787974 -0.33930006327972422886;-0.8196715252386331807 0.11047854681073623895 -0.045770149407594037938 -0.40173049103796226733 0.6287484895685436781 0.86484013228703249254 -0.17618192846217123337 1.5486280640593363955 0.63771293271737627961 -1.4440858529743174632 -0.37811615669841702747 -1.1519499381984557029 1.3959721539519851508 -0.45174195542017642202;-0.77109401081517037202 0.062434225706839804881 -0.054215270005197824243 -0.3614288987724673663 0.65306668092453090679 0.89194262850537542331 -0.16908067273446034107 1.6428477167511548185 0.4960241912805209985 -1.5114664441036282927 -0.60646546603315565349 -1.2017894556620034585 1.4287179337307429616 -0.54360576168003171826;-0.73092921423289458627 0.23254612886004430439 -0.060952425015730851698 -0.32629213194690565025 0.6730140666515035397 0.91358162138165899258 -0.16253535264702809182 1.7276705911792467063 0.36501620746577273513 -1.5707207893564896217 -0.81438152281149089884 -1.2444829029131776466 1.4562787304287154733 -0.61895065567367080206;-0.69707936660000957563 0.30440741930185472031 -0.066289059310211922993 -0.29536693444232853256 0.68936125193109287768 0.93092329206869095515 -0.15674817049334888175 1.8040181201084823925 0.24526320709378796048 -1.6231968834901524534 -1.0029002627391543356 -1.2811905095073052863 1.4797447534931651436 -0.68245205309796297399];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.000512226018050363;0.000308134497287773;0.000235603722003516;0.000197382386246029;0.000173329147318873;0.000156560839315145;0.000144063610768706;0.000134303255326914;0.000126411888057116;0.000119860003755334];
y1_step1.xoffset = [246.25792;461.32665;664.62166;860.12562;1049.6188;1234.1264;1414.3177;1590.7342;1763.7242;1933.6147];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
